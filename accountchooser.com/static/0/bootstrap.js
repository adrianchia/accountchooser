/* Copyright 2012 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

(function(){var a=void 0,g=!0,h=null,i=!1,k=window,l=document,n=JSON,o=jQuery,aa=navigator;function ba(b,c){return b.onload=c}function ca(b,c){return b.toJSON=c}function da(b,c){return b.onreadystatechange=c}
var p="origin",q="exec",r="replace",s="data",ea="extend",t="sessionStorage",u="trim",v="createElement",w="setAttribute",fa="attachEvent",x="getTime",y="documentElement",z="toString",ga="toJSON",A="queue",B="setTimeout",C="split",D="inArray",E="location",ha="localStorage",ia="removeItem",F="options",G="displayName",H="isArray",ja="postMessage",I="push",J="Request",K="stringify",M="indexOf",N="readyState",O="param",ka="name",la="parse",P="length",Q="language",R="prototype",ma="clientWidth",S="document",
T="body",U="call",na="clientHeight",V="toLowerCase",W="",oa=" from ",pa='", must be under domain "',qa='".',ra="\"]', not exist.",sa="\"]'.",ta="#",ua="&",va="'",wa="' found!",xa="' has't initialized yet.",ya="', uuid='",za="'.",Aa="': no valid iframeUrl.",Ba="(^|;) ?",Ca="*",Da="-9999px",Ea=".",Fa="//",Ga="1px",Ha="2.0",X=":",Ia="; expires=",Ja="; path=/",Ka="<iframe />",La="=",Ma="=([^;]*)(;|$)",Na="=; expires=",Oa="?",Pa="@",Qa="Caja process stoped due to timeout.",Ra="CallClient failed: cannot find client window.",
Sa="Clear CDS browser config.",Ta="Error request format: ",Ua="Failed to clear from DOM storage: ",Va="Failed to clear from cookie: ",Wa="Failed to find callback for response: ",Xa="Failed to find widget with uuid '",Ya="Failed to get client domain in URL hash.",Za="Failed to init IDP iframe for '",$a="Failed to parse request: ",bb="Failed to read from DOM storage: ",cb="Failed to read from cookie: ",db="Failed to write to DOM storage: ",eb="Failed to write to cookie: ",fb="GET",gb="Get CDS browser config: ",
hb="Guest code rendered successfully.",ib="Ignore expired JSON-RPC object: [",jb="Ignore invalid JSON-RPC object: [",kb='Illegal clientCallbackUrl "',lb='Illegal negativeCallbackUrl "',mb='Illegal positiveCallbackUrl "',nb="Illegal request: ",ob="Illegal state error: IDP domain '",pb="Invalid JSON-RPC object: not a JSON object.",qb="Invalid JSON-RPC request: 'jsonrpc' field should be '2.0'.",rb="Invalid value for 'options.emailMapIdp.[\"",sb="Invalid value for 'options.emailMapIdp[\"",tb="MSIE",ub=
"No RPC handler for '",vb="No content returned in the HTML file.",wb="Parameter %%param%% cannot be an empty array.",xb="Parameter %%param%% cannot be empty.",yb="Parameter %%param%% cannot be null.",zb="Parameter %%param%% is not a function.",Ab="Parameter %%param%% is not an array.",Bb="Read saved accounts from storage: ",Cb="Received message: ",Db="Register handler for postMessage failed.",Eb="Save accounts to storage: ",Fb="Send message: ",Gb="Set CDS browser config: ",Hb="Successfully parsing request: ",
Ib="Timeout when initializing Caja.",Jb="Timeout when loading caja.js.",Kb="Timeout when loading raw HTML.",Lb="Unimplementated! Child object must provide an implementation.",Mb="Unrecognized request: ",Nb="Unsupported IDP '",Ob="Unsupported IDP domain '",Pb="[object Array]",Qb="[object Function]",Rb="]",Sb="_",Tb="absolute",Ub="account",Vb="body",Wb="cajole",Xb="callback",Yb="chooserAccounts",Zb="complete",$b="cookieName",ac="disabled",bc="domStorageKey",cc="domain",dc="en",ec="form",fc="handler",
gc="head",hc="height",ic="hidden",jc="href",kc="html",lc="http://",mc="https://ssl.gstatic.com/caja/",Y="id",nc="idpConfig",oc="iframeUrl",pc="input",qc="jsUrl",rc="left",sc="link",tc="loaded",uc="localStorage",vc="manage",wc="message",xc="name",yc="object",zc="onmessage",Ac="opt_cookieName",Bc="opt_domStorageKey || opt_cookieName",Cc="parentClass",Dc="position",Ec="post",Fc="query",Gc="rel",Hc="request",Ic="requestId",Jc="rpcObject",Kc="sanitize",Lc="script",Mc="semaphore value decrease to ",Nc=
"serviceMeta",Oc="serviceMeta.name",Pc="serviceName",Qc="sessionStorage",Rc="src",Sc="string",Tc="stylesheet",Uc="targetWindow",Vc="text/css",Wc="text/html",Xc="text/javascript",Yc="timeout",Zc="timeoutCallback",$c="type",ad="value",bd="width",cd="window",dd="window.notifyWidget: type='",Z;k.accountchooser=k.accountchooser||{};k.cds=k.accountchooser;k.accountchooser.util=k.accountchooser.util||{};k.accountchooser.util.log=function(b){try{k.console&&k.console.log&&k.console.log(b)}catch(c){}};
k.accountchooser.util.uuidCounter_=(new Date)[x]();k.accountchooser.util.generateUuid=function(b){return b&&b.uuid?b.uuid:++k.accountchooser.util.uuidCounter_};k.accountchooser.util.createForm_=function(b,c,d){if(!b)throw"The targetUrl cannot be null.";var e=k[S][v](ec);e.method=Ec;e.action=b;if(c)for(var f in c)b=k[S][v](pc),b[w]($c,ic),b[w](xc,f),c[f]===h||c[f]===a?b[w](ad,W):b[w](ad,c[f]),e.appendChild(b);d&&(e.target=d);k[S][T].appendChild(e);return e};
k.accountchooser.util.postTo=function(b,c,d){b=k.accountchooser.util.createForm_(b,c,d);b.submit();k[S][T].removeChild(b)};k.accountchooser.util.parseUrlParams=function(b){for(var c={},b=b.slice(b[M](Oa)+1)[C](ua),d=0;d<b[P];d++){var e=b[d][C](La);c[e[0]]=2==e[P]?decodeURIComponent(e[1]):a}return c};k.accountchooser.util.formRedirect=function(b,c){var d=b.substring(0,b[M](Oa)),e=k.accountchooser.util.parseUrlParams(b);k.accountchooser.util.postTo(d,e,c)};
k.accountchooser.util.isBrowserSupported=function(){var b=999;-1!=aa.appVersion[M](tb)&&(b=parseFloat(aa.appVersion[C](tb)[1]));return 7<b};k.accountchooser.util.makeUrl=function(b,c){var d=[],e;for(e in c)d[I](c[e]?e+La+c[e]:e);return b+Oa+d.join(ua)};k.accountchooser.util.isArray=function(b){return"undefined"!==typeof o?o[H](b):Object[R][z][U](b)===Pb};k.accountchooser.util.isFunction=function(b){return"undefined"!==typeof o?o.isFunction(b):Object[R][z][U](b)===Qb};
k.accountchooser.util.indexOf=function(b,c){if(c){if("undefined"!==typeof o)return o[D](b,c);if(c[M])return c[M](b);for(var d=c[P],e=0;e<d;e++)if(e in c&&c[e]===b)return e}return-1};k.accountchooser.util.windowWidth=function(b){if("undefined"!==typeof o)return o(b).width();var c=0;b.innerWidth?c=b.innerWidth:b[S]&&b[S][y]&&b[S][y][ma]?c=b[S][y][ma]:b[S]&&(b[S][T]&&b[S][T][ma])&&(c=b[S][T][ma]);return c};
k.accountchooser.util.windowHeight=function(b){if("undefined"!==typeof o)return o(b).height();var c=0;b.innerHeight?c=b.innerHeight:b[S]&&b[S][y]&&b[S][y][na]?c=b[S][y][na]:b[S]&&(b[S][T]&&b[S][T][na])&&(c=b[S][T][na]);return c};k.accountchooser.util.trim=function(b){return"undefined"!==typeof o?o[u](b):b==h?W:String[R][u]?String[R][u][U](b):b[r](/^[\s\xa0]+/,W)[r](/[\s\xa0]+$/,W)};
k.accountchooser.util.extend=function(b,c,d){if(3>arguments[P])return c||{};if("undefined"!==typeof o){var e=Array[R].slice[U](arguments,b?0:1);return o[ea].apply(o,e)}if(typeof c!==yc||c==h)c={};for(var e=2,f=arguments[P];e<f;e++){var j=arguments[e];if(j!=h)for(var m in j)j[m]===a||c===j[m]||(b&&typeof j[m]==yc?(k.accountchooser.util[H](j[m])&&!k.accountchooser.util[H](c[m])&&(c[m]=[]),c[m]=k.accountchooser.util[ea](g,c[m],j[m])):c[m]=j[m])}return c};k.accountchooser.param={};
k.accountchooser[O].notNull=function(b,c){(b===a||b===h)&&k.accountchooser[O].throwError_(yb,c)};k.accountchooser[O].notEmpty=function(b,c){b||k.accountchooser[O].throwError_(xb,c)};k.accountchooser[O].notEmptyArray=function(b,c){b||k.accountchooser[O].throwError_(xb,c);k.accountchooser.util[H](b)||k.accountchooser[O].throwError_(Ab,c);b[P]||k.accountchooser[O].throwError_(wb,c)};
k.accountchooser[O].notEmptyFunction=function(b,c){b||k.accountchooser[O].throwError_(xb,c);k.accountchooser.util.isFunction(b)||k.accountchooser[O].throwError_(zb,c)};k.accountchooser[O].throwError_=function(b,c){try{console&&console.trace&&console.trace()}catch(d){}throw b[r](/\%\%param\%\%/g,c?" '"+c+va:W);};Function[R].inheritsFrom=function(b){k.accountchooser[O].notEmptyFunction(b,Cc);this.prototype=new b;this[R].constructor=this;this[R].parentClass=b[R]};
k.accountchooser.util.VALID_EMAIL_REGEX_=/^[a-z0-9]+(\.?[-+\w]+)*@([a-z0-9]([-a-z0-9]*[a-z0-9])?\.)+[a-z0-9]+$/i;k.accountchooser.util.VALID_DOMAIN_REGEX_=/^([a-z0-9]([-a-z0-9]*[a-z0-9])?\.)+[a-z0-9]+$/i;k.accountchooser.util.isValidEmail=function(b){return b&&h!=k.accountchooser.util.VALID_EMAIL_REGEX_[q](b)};k.accountchooser.util.isValidDomain=function(b){return b&&h!=k.accountchooser.util.VALID_DOMAIN_REGEX_[q](b)};
k.accountchooser.util.getEmailDomain=function(b){if((b=k.accountchooser.util[u](b))&&k.accountchooser.util.isValidEmail(b))return b[C](Pa)[1][V]()};k.accountchooser.util.getEmailUsername=function(b){if((b=k.accountchooser.util[u](b))&&k.accountchooser.util.isValidEmail(b))return b[C](Pa)[0][V]()};k.accountchooser.util.isDomainInNascar=function(b){if(b){var c=k.accountchooser.config.idps,d;for(d in c){var e=c[d];if(e&&e.domain==b)return d}}};k.accountchooser.util.USERNAME_REGEX=/^\w+(\.\w+)*$/;
k.accountchooser.util.isValidUsername=function(b){return k.accountchooser.config?k.accountchooser.config.disableUsernameFormatCheck?!!b:k.accountchooser.config.usernameRegex?!!b&&h!=k.accountchooser.config.usernameRegex[q](b):!!b&&h!=k.accountchooser.util.USERNAME_REGEX[q](b):!!b&&h!=k.accountchooser.util.USERNAME_REGEX[q](b)};k.accountchooser.util.DOMAIN_REGEX_=/:\/\/(.[^\/?]+)/;k.accountchooser.util.VALID_URL_DOMAIN_REGEX_=/^([a-z0-9]([-a-z0-9]*[a-z0-9])?\.)+[a-z0-9]+(\:\d+)?$/i;
k.accountchooser.util.getDomainFromUrl=function(b){try{return b.match(k.accountchooser.util.DOMAIN_REGEX_)[1]}catch(c){}};k.accountchooser.util.isValidUrlDomain=function(b){return b?k.accountchooser.util.VALID_URL_DOMAIN_REGEX_.test(b):i};k.accountchooser.util.MOBILE_REGEX_=/iphone|ipad|ipod|android|blackberry|mini|iemobile|windows\sce|palm/i;k.accountchooser.util.isMobileAgent=function(b){return b&&k.accountchooser.util.MOBILE_REGEX_.test(b[V]())};
k.accountchooser.util.SUPPORTED_LANGUAGE_=[dc,"en_gb","fr","it","de","es","zh_cn","zh_tw","ja","ko","nl","pl","pt","ru","th","tr","bg","ca","hr","cs","da","fil","fi","el","hi","hu",Y,"lv","lt","no","pt_pt","ro","sr","sk","sl","sv","uk","vi"];
k.accountchooser.util.ALTERNATIVE_CODES_MAP_={en_us:dc,zh:"zh_cn",zh_hans:"zh_cn",zh_hans_cn:"zh_cn",zh_hant:"zh_tw",zh_hant_tw:"zh_tw",nl_nl:"nl",fr_fr:"fr",de_de:"de",it_it:"it",ja_jp:"ja",ko_kr:"ko",pl_pl:"pl",pt_br:"pt",ru_ru:"ru",es_es:"es",th_th:"th",tr_tr:"tr",bg_bg:"bg",ca_es:"ca",hr_hr:"hr",cs_cz:"cs",da_dk:"da",fil_ph:"fil",tl:"fil",fi_fi:"fi",el_gr:"el",hi_in:"hi",hu_hu:"hu",id_id:Y,lv_lv:"lv",lt_lt:"lt",no_no:"no",nb:"no",nb_no:"no",ro_ro:"ro",sr_cyrl_rs:"sr",sk_sk:"sk",sl_si:"sl",sv_se:"sv",
uk_ua:"uk",vi_vn:"vi"};k.accountchooser.util.findLanguageCode=function(b){for(var b=b&&b[r](/-/g,Sb)[V](),c;b;){if(-1<o[D](b,k.accountchooser.util.SUPPORTED_LANGUAGE_)){c=b;break}else if(k.accountchooser.util.ALTERNATIVE_CODES_MAP_[b]){c=k.accountchooser.util.ALTERNATIVE_CODES_MAP_[b];break}b=b[C](Sb);b.pop();b=b.join(Sb)}return c};k.accountchooser.util.getNamespacedObjectByString=function(b){for(var c=b[C](Ea),d=0,e=c[P],f=k;d<e;++d)f=0==d&&c[0]==cd?k:f[c[d]],k.accountchooser[O].notNull(f,b);return f};
k.accountchooser.util.REGISTRY_KEY_PREFIX_="widget_";k.accountchooser.util.widgets_={};k.accountchooser.util.registerWidget=function(b,c){k.accountchooser.util.widgets_[k.accountchooser.util.REGISTRY_KEY_PREFIX_+b]=c};k.accountchooser.util.unregisterWidget=function(b){delete k.accountchooser.util.widgets_[k.accountchooser.util.REGISTRY_KEY_PREFIX_+b]};
k.accountchooser.util.getWidget_=function(b){var c;if(b){var d=k.accountchooser.util.REGISTRY_KEY_PREFIX_+b;c=k.accountchooser.util.widgets_[d]}else for(d in k.accountchooser.util.widgets_){c=k.accountchooser.util.widgets_[d];break}return c};k.accountchooser.util.notifyWidget=function(b,c,d){k.accountchooser.util.log(dd+b+ya+d+va);var e=k.accountchooser.util.getWidget_(d);if(e){var f=o[ea]({},c);k[B](function(){e.handleNotification(b,f)},200)}else k.accountchooser.util.log(Xa+d+za)};
k.accountchooser.util.Storage=function(b,c,d){k.accountchooser[O].notEmpty(b||c,Bc);k.accountchooser.util.Storage.isDomStorageSupported(d)||k.accountchooser[O].notEmpty(c,Ac);this.domStorageKey_=b;this.cookieName_=c;this.perSession_=d};k.accountchooser.util.Storage.isDomStorageSupported=function(b){try{return b?Qc in k&&k[t]!=h:uc in k&&k[ha]!=h}catch(c){return i}};Z=k.accountchooser.util.Storage[R];
Z.read=function(){if(k.accountchooser.util.Storage.isDomStorageSupported(this.perSession_)&&this.isDomStorageAllowed_())return this.readFromDomStorage_();if(this.isCookieStorageAllowed_())return this.readFromCookie_()};Z.write=function(b){k.accountchooser.util.Storage.isDomStorageSupported(this.perSession_)&&this.isDomStorageAllowed_()?this.writeToDomStorage_(b):this.isCookieStorageAllowed_()&&this.writeToCookie_(b)};
Z.clear=function(){k.accountchooser.util.Storage.isDomStorageSupported(this.perSession_)&&this.isDomStorageAllowed_()&&this.clearFromDomStorage_();this.isCookieStorageAllowed_()&&this.clearFromCookie_()};Z.isDomStorageAllowed_=function(){return!!this.domStorageKey_};Z.isCookieStorageAllowed_=function(){return!!this.cookieName_};
Z.readFromDomStorage_=function(){k.accountchooser[O].notEmpty(this.domStorageKey_,bc);var b=this.perSession_?k[t]:k[ha];try{var c=b.getItem(this.domStorageKey_);if(c)return n[la](c)}catch(d){k.accountchooser.util.log(bb+d)}};Z.writeToDomStorage_=function(b){k.accountchooser[O].notEmpty(this.domStorageKey_,bc);var c=this.perSession_?k[t]:k[ha];try{var d=n[K](b);c.setItem(this.domStorageKey_,d)}catch(e){k.accountchooser.util.log(db+e)}};
Z.clearFromDomStorage_=function(){k.accountchooser[O].notEmpty(this.domStorageKey_,bc);var b=this.perSession_?k[t]:k[ha];try{b[ia](this.domStorageKey_)}catch(c){k.accountchooser.util.log(Ua+c)}};Z.readFromCookie_=function(){k.accountchooser[O].notEmpty(this.cookieName_,$b);var b=l.cookie.match(Ba+this.cookieName_+Ma);if(b&&(b=k.accountchooser.util[u](b[2])))try{return n[la](unescape(b))}catch(c){k.accountchooser.util.log(cb+c)}};
Z.writeToCookie_=function(b){k.accountchooser[O].notEmpty(this.cookieName_,$b);try{var c=new Date,d=c.getFullYear()+10,e=c.getMonth(),f=c.getDate(),j=new Date(d,e,f),m=this.perSession_?0:j.toGMTString();l.cookie=this.cookieName_+La+escape(n[K](b))+Ia+m+Ja}catch(L){k.accountchooser.util.log(eb+L)}};
Z.clearFromCookie_=function(){k.accountchooser[O].notEmpty(this.cookieName_,$b);try{var b=new Date;b.setTime(b[x]()-1);l.cookie=this.cookieName_+Na+b.toGMTString()+Ja}catch(c){k.accountchooser.util.log(Va+c)}};k.accountchooser.util.accountstorage={};k.accountchooser.util.accountstorage.ACCOUNTS_=Yb;k.accountchooser.util.accountstorage.AC_COOKIE_NAME_="__goog__ac__";k.accountchooser.util.accountstorage.storage_=new k.accountchooser.util.Storage(k.accountchooser.util.accountstorage.ACCOUNTS_,k.accountchooser.util.accountstorage.AC_COOKIE_NAME_);
k.accountchooser.util.accountstorage.read_=function(){var b=k.accountchooser.util.accountstorage.storage_.read();k.accountchooser.util.log(Bb+n[K](b));return b};k.accountchooser.util.accountstorage.write_=function(b){k.accountchooser.util.log(Eb+n[K](b));k.accountchooser.util.accountstorage.storage_.write(b)};k.accountchooser.util.accountstorage.readAccounts=function(){var b=k.accountchooser.util.accountstorage.read_();if(!b||!k.accountchooser.util[H](b))b=[];return b};
k.accountchooser.util.accountstorage.addAccount=function(b){if(!b||!b.email)return i;for(var c=i,d=k.accountchooser.util.accountstorage.readAccounts(),e,f=0;f<d[P];f++)if(k.accountchooser.util.accountstorage.matchAccount_(d[f],b.email,b.providerId)){e=d[f];d.splice(f,1);c=g;break}if(e&&(!b[G]&&e[G]&&(b.displayName=e[G]),!b.photoUrl&&e.photoUrl))b.photoUrl=e.photoUrl;d.unshift(b);k.accountchooser.util.accountstorage.write_(d);return!c};
k.accountchooser.util.accountstorage.removeAccount=function(b){if(!b||!b.email)return i;for(var c=i,d=k.accountchooser.util.accountstorage.readAccounts(),e=0;e<d[P];e++)if(k.accountchooser.util.accountstorage.matchAccount_(d[e],b.email,b.providerId)){d.splice(e,1);c=g;break}k.accountchooser.util.accountstorage.write_(d);return c};k.accountchooser.util.accountstorage.clearAccounts=function(){k.accountchooser.util.accountstorage.storage_.clear()};
k.accountchooser.util.accountstorage.updateAccount=function(b,c,d){if(b)for(var e=k.accountchooser.util.accountstorage.readAccounts(),f=0;f<e[P];f++)if(k.accountchooser.util.accountstorage.matchAccount_(e[f],b,d)){c(e[f]);k.accountchooser.util.accountstorage.write_(e);break}};
k.accountchooser.util.accountstorage.refreshAccount=function(b){b&&b.email&&k.accountchooser.util.accountstorage.updateAccount(b.email,function(c){b[G]&&(c.displayName=b[G]);b.photoUrl&&(c.photoUrl=b.photoUrl);b.legacy!=a&&(c.legacy=b.legacy)})};
k.accountchooser.util.accountstorage.fetchAccount=function(b,c){if(b)for(var d=k.accountchooser.util.accountstorage.readAccounts(),e=0;e<d[P];e++)if(k.accountchooser.util.accountstorage.matchAccount_(d[e],b,c)){var f=d[e];d.splice(e,1);d.unshift(f);k.accountchooser.util.accountstorage.write_(d);return f}};k.accountchooser.util.accountstorage.matchAccount_=function(b,c,d){return b.email!=c?i:b.providerId&&d&&b.providerId==d||!b.providerId&&!d?g:i};k.accountchooser.updateSavedAccount=function(b){k.accountchooser.util.accountstorage.addAccount(b)};
k.accountchooser.removeSavedAccount=function(b){return k.accountchooser.util.accountstorage.removeAccount(b)};k.accountchooser.clearSavedAccounts=function(){k.accountchooser.util.accountstorage.clearAccounts()};k.accountchooser.util.accountstorage.ACCOUNTS_=Yb;k.accountchooser.util.accountstorage.storage_=new k.accountchooser.util.Storage(k.accountchooser.util.accountstorage.ACCOUNTS_);k.accountchooser.util.accountstorage.NO_IDP_="NO_IDP";
k.accountchooser.util.accountstorage.readAccounts=function(b){var c=k.accountchooser.util.accountstorage.read_();if(!c||!k.accountchooser.util[H](c))c=[];if(!b)return c;var d=[];if(b.withEmail){var e=function(b){return k.accountchooser.util.isValidEmail(b.email)};d[I](e)}b.idpList&&0!=b.idpList[P]&&(e=function(c){return 0<=k.accountchooser.util[M](c.providerId||k.accountchooser.util.accountstorage.NO_IDP_,b.idpList)},d[I](e));b.emailDomainList&&0!=b.emailDomainList[P]&&(e=function(c){return(c=k.accountchooser.util.getEmailDomain(c.email))?
k.accountchooser.util[M](c,b.emailDomainList)>=0:g},d[I](e));for(e=0;e<d[P];e++)c=k.accountchooser.util.accountstorage.filter_(c,d[e]);return c};k.accountchooser.util.accountstorage.filter_=function(b,c){for(var d=[],e=0;e<b[P];e++)c(b[e])&&d[I](b[e]);return d};k.accountchooser.util.browserconfig={};k.accountchooser.util.browserconfig.SETTINGS_KEY_="cdsSettings";k.accountchooser.util.browserconfig.COOKIE_NAME_="__cds__settings__";
k.accountchooser.util.browserconfig.storage_=new k.accountchooser.util.Storage(k.accountchooser.util.browserconfig.SETTINGS_KEY_,k.accountchooser.util.browserconfig.COOKIE_NAME_);k.accountchooser.util.browserconfig.getAll=function(){var b=k.accountchooser.util.browserconfig.storage_.read()||{};k.accountchooser.util.log(gb+n[K](b));return b};k.accountchooser.util.browserconfig.setAll=function(b){k.accountchooser.util.log(Gb+n[K](b));k.accountchooser.util.browserconfig.storage_.write(b)};
k.accountchooser.util.browserconfig.clearAll=function(){k.accountchooser.util.log(Sa);k.accountchooser.util.browserconfig.storage_.clear()};k.accountchooser.util.browserconfig.get=function(b){return k.accountchooser.util.browserconfig.getAll()[b]};k.accountchooser.util.browserconfig.set=function(b,c){var d=k.accountchooser.util.browserconfig.getAll();d[b]=c;k.accountchooser.util.browserconfig.setAll(d)};
k.accountchooser.util.browserconfig.clear=function(b){var c=k.accountchooser.util.browserconfig.getAll();delete c[b];k.accountchooser.util.browserconfig.setAll(c)};k.accountchooser.util.browserconfig.isDisabled=function(){return!!k.accountchooser.util.browserconfig.get(ac)};k.accountchooser.util.browserconfig.setDisabled=function(b){k.accountchooser.util.browserconfig.set(ac,!!b)};k.accountchooser.loader=k.accountchooser.loader||{};k.accountchooser.loader.Loader=function(){};
k.accountchooser.loader.Loader[R].load=function(b,c,d,e){var f=this;this.load_(b,d,function(){c?f.load_(c,d,e):e()})};k.accountchooser.loader.Loader[R].load_=function(b,c,d){var e=l.getElementsByTagName(gc)[0]||l[y],f=this.createResourceElement(b),j=i;ba(f,da(f,function(){if(!j&&(!this[N]||this[N]===tc||this[N]===Zb))j=g,ba(f,da(f,h)),c&&c()}));f.onerror=function(){e.removeChild(f);d&&d()};e.insertBefore(f,e.firstChild)};
k.accountchooser.loader.Loader[R].createResourceElement=function(){throw"Unimplemented! Child object must provide an implementation.";};k.accountchooser.loader.JsLoader=function(){};k.accountchooser.loader.JsLoader.inheritsFrom(k.accountchooser.loader.Loader);k.accountchooser.loader.JsLoader[R].createResourceElement=function(b){var c=l[v](Lc);c[w]($c,Xc);c[w](Rc,b);return c};k.accountchooser.loader.CssLoader=function(){};k.accountchooser.loader.CssLoader.inheritsFrom(k.accountchooser.loader.Loader);
k.accountchooser.loader.CssLoader[R].createResourceElement=function(b){var c=l[v](sc);c[w]($c,Vc);c[w](Gc,Tc);c[w](jc,b);return c};k.accountchooser.util.Semaphore=function(b,c){k.accountchooser[O].notEmptyFunction(b,fc);if(0>c)throw"Semaphore value cannot be negative.";this.handler_=b;this.value_=c||0;this.started_=i};Z=k.accountchooser.util.Semaphore[R];Z.getValue=function(){return this.value_};Z.increase=function(){if(this.started_)throw"Cannot increase Semaphore value after calling start().";this.value_++};
Z.start=function(){if(0>=this.value_)throw"Semaphore value must bigger than 0.";this.started_=g};Z.isStarted=function(){return this.started_};Z.decrease=function(){if(!this.started_)throw"Cannot decrease Semaphore value before calling start().";0<this.value_&&(this.value_--,k.accountchooser.util.log(Mc+this.value_),0==this.value_&&this.handler_())};k.accountchooser.caja=k.accountchooser.caja||{};
k.accountchooser.caja.loadHtml=function(b,c,d,e){o.ajax({type:fb,url:b,dataType:kc,success:d,timeout:c,error:function(b,c,d){e&&e(c,d)}})};k.accountchooser.caja.loadJs_=function(b,c,d){(new k.accountchooser.loader.JsLoader).load(b,a,c,d)};k.accountchooser.caja.loadedUrls_={};k.accountchooser.caja.loadedCallback_=function(b){if(b&&(b=k.accountchooser.caja.loadedUrls_[b])){b.loaded=g;for(var c=0;c<b.callbacks[P];c++){var d=b.callbacks[c];d&&d()}b.callbacks=[];b.error=i;b.errorCallbacks=[]}};
k.accountchooser.caja.errorCallback_=function(b,c,d){if(b&&(b=k.accountchooser.caja.loadedUrls_[b])){b.loaded=g;b.error=g;for(var e=0;e<b.errorCallbacks[P];e++){var f=b.errorCallbacks[e];f&&f(c,d)}b.errorCallbacks=[];b.callbacks=[]}};
k.accountchooser.caja.loadJs=function(b,c,d){k.accountchooser[O].notEmpty(b,qc);var e=k.accountchooser.caja.loadedUrls_[b];e?e.loaded?e.error?d&&d():c():(e.callbacks[I](c),d&&e.errorCallbacks[I](d)):(k.accountchooser.caja.loadedUrls_[b]={loaded:i,callbacks:[c]},k.accountchooser.caja.loadJs_(b,function(){k.accountchooser.caja.loadedCallback_(b)},function(){k.accountchooser.caja.errorCallback_(b)}))};k.accountchooser.caja=k.accountchooser.caja||{};k.accountchooser.caja.cajaUrl="https://ssl.gstatic.com/caja/4891/caja.js";
k.accountchooser.caja.htmlSanitizerUrl="https://ssl.gstatic.com/caja/4891/html-css-sanitizer-minified.js";k.accountchooser.caja.CAJA_TIMEOUT=5E3;k.accountchooser.caja.WHITELIST_IDS=["AC_LANGUAGE_LIST"];k.accountchooser.caja=k.accountchooser.caja||{};
k.accountchooser.caja.sanitizeHtml=function(b,c,d){function e(b){0>m-(new Date)[x]()?d(Yc):(b=html_sanitize(b,j,f),c(b))}function f(b){if(0<=o[D](b,k.accountchooser.caja.WHITELIST_IDS))return b}function j(b){return b}var m=(new Date)[x]()+k.accountchooser.caja.CAJA_TIMEOUT;k.accountchooser.caja.loadJs(k.accountchooser.caja.htmlSanitizerUrl,function(){var c=m-(new Date)[x]();50>c?d(Yc):k.accountchooser.caja.loadHtml(b,c,e,d)})};
k.accountchooser.caja.cajoleHtml=function(b,c,d,e){function f(){if(L)k.accountchooser.util.log(Jb);else{var b=fd-(new Date)[x]();50>b?k.accountchooser.util.log(Jb):k.accountchooser.caja.loadHtml(c,b,function(b){k[B](function(){L?k.accountchooser.util.log(Kb):b?(k.accountchooser.caja.cajaInitialized||(k.accountchooser.caja.cajaInitialized=g,caja.initialize({cajaServer:mc,forceES5Mode:g})),k[B](function(){L?k.accountchooser.util.log(Ib):caja.load(m,j,function(c){c.code(a,Wc,b).run(function(){L||k.clearTimeout(gd);
ab=g;d&&d();k.accountchooser.util.log(hb)})})},10)):k.accountchooser.util.log(vb)},10)})}}var j={rewrite:function(b){return b}},m=l.getElementById(b),L=i,ab=i,gd=k[B](function(){k.accountchooser.util.log(Qa);L=g;!ab&&e&&e()},k.accountchooser.caja.CAJA_TIMEOUT),fd=(new Date)[x]()+k.accountchooser.caja.CAJA_TIMEOUT;k.accountchooser.caja.loadJs(k.accountchooser.caja.cajaUrl,function(){k[B](f,10)})};k.accountchooser.rpc=k.accountchooser.rpc||{};k.accountchooser.rpc.RpcObject=function(){};
k.accountchooser.rpc.RpcObject[R].setTimestamp=function(b){this.timestamp_=b||(new Date)[x]()};ca(k.accountchooser.rpc.RpcObject[R],function(){var b={jsonrpc:Ha};this.timestamp_!=h&&(b.timestamp=this.timestamp_);return b});k.accountchooser.rpc.RpcObject[R].toString=function(){return n[K](this[ga]())};k.accountchooser.rpc.AbstractRequest=function(b,c){this.method_=b;this.params_=c};k.accountchooser.rpc.AbstractRequest.inheritsFrom(k.accountchooser.rpc.RpcObject);Z=k.accountchooser.rpc.AbstractRequest[R];
Z.setMethod=function(b){this.method_=b};Z.getMethod=function(){return this.method_};Z.setParameters=function(b){this.params_=b};Z.getParameters=function(){return this.params_};ca(Z,function(){var b=k.accountchooser.rpc.RpcObject[R][ga][U](this);this.method_!=h&&(b.method=this.method_);this.params_!=h&&(b.params=this.params_);return b});k.accountchooser.rpc.Notification=function(b,c){this.method_=b;this.params_=c};k.accountchooser.rpc.Notification.inheritsFrom(k.accountchooser.rpc.AbstractRequest);
k.accountchooser.rpc.Request=function(b,c,d){this.method_=b;this.params_=c;this.id_=d};k.accountchooser.rpc[J].inheritsFrom(k.accountchooser.rpc.AbstractRequest);k.accountchooser.rpc[J][R].setId=function(b){this.id_=b};k.accountchooser.rpc[J][R].getId=function(){return this.id_};ca(k.accountchooser.rpc[J][R],function(){var b=k.accountchooser.rpc.AbstractRequest[R][ga][U](this);this.id_!=h&&(b.id=this.id_);return b});
k.accountchooser.rpc.Response=function(b,c,d){k.accountchooser[O].notEmpty(b,Y);this.id_=b;this.result_=c;this.error_=d};k.accountchooser.rpc.Response.inheritsFrom(k.accountchooser.rpc.RpcObject);Z=k.accountchooser.rpc.Response[R];Z.getResult=function(){return this.result_};Z.setResult=function(b){this.result_=b};Z.getError=function(){return this.error_};Z.setError=function(b){this.error_=b};Z.setId=function(b){this.id_=b};Z.getId=function(){return this.id_};
ca(Z,function(){var b=k.accountchooser.rpc.RpcObject[R][ga][U](this);b.id=this.id_;this.result_!=h?b.result=this.result_:this.error_!=h&&(b.error=this.error_);return b});k.accountchooser.rpc.RequestAckNotification=function(b){k.accountchooser[O].notEmpty(b,Ic);this.method_=k.accountchooser.rpc.RequestAckNotification.METHOD;this.params_={requestId:b}};k.accountchooser.rpc.RequestAckNotification.inheritsFrom(k.accountchooser.rpc.Notification);k.accountchooser.rpc.RequestAckNotification.METHOD="requestAckNotification";
k.accountchooser.rpc.RequestAckNotification[R].setRequestId=function(b){this.params_.requestId=b};k.accountchooser.rpc.RequestAckNotification[R].getRequestId=function(){return this.params_.requestId};k.accountchooser.rpc.CdsReadyNotification=function(){this.method_=k.accountchooser.rpc.CdsReadyNotification.METHOD};k.accountchooser.rpc.CdsReadyNotification.inheritsFrom(k.accountchooser.rpc.Notification);k.accountchooser.rpc.CdsReadyNotification.METHOD="cdsReadyNotification";
k.accountchooser.rpc.ClientReadyNotification=function(){this.method_=k.accountchooser.rpc.ClientReadyNotification.METHOD};k.accountchooser.rpc.ClientReadyNotification.inheritsFrom(k.accountchooser.rpc.Notification);k.accountchooser.rpc.ClientReadyNotification.METHOD="clientReadyNotification";k.accountchooser.rpc.EmptyResponseNotification=function(){this.method_=k.accountchooser.rpc.EmptyResponseNotification.METHOD};k.accountchooser.rpc.EmptyResponseNotification.inheritsFrom(k.accountchooser.rpc.Notification);
k.accountchooser.rpc.EmptyResponseNotification.METHOD="emptyResponseNotification";k.accountchooser.rpc.StoreRequest=function(b,c,d,e){k.accountchooser[O].notEmpty(b,Y);k.accountchooser[O].notEmpty(c,Ub);this.method_=k.accountchooser.rpc.StoreRequest.METHOD;this.params_={account:c,localAccounts:d,clientConfig:e};this.id_=b};k.accountchooser.rpc.StoreRequest.inheritsFrom(k.accountchooser.rpc[J]);k.accountchooser.rpc.StoreRequest.METHOD="store";
k.accountchooser.rpc.SelectRequest=function(b,c,d){k.accountchooser[O].notEmpty(b,Y);this.method_=k.accountchooser.rpc.SelectRequest.METHOD;this.params_={localAccounts:c,clientConfig:d};this.id_=b};k.accountchooser.rpc.SelectRequest.inheritsFrom(k.accountchooser.rpc[J]);k.accountchooser.rpc.SelectRequest.METHOD="select";
k.accountchooser.rpc.UpdateRequest=function(b,c,d){k.accountchooser[O].notEmpty(b,Y);k.accountchooser[O].notEmpty(c,Ub);this.method_=k.accountchooser.rpc.UpdateRequest.METHOD;this.params_={account:c,clientConfig:d};this.id_=b};k.accountchooser.rpc.UpdateRequest.inheritsFrom(k.accountchooser.rpc[J]);k.accountchooser.rpc.UpdateRequest.METHOD="update";
k.accountchooser.rpc.ManageRequest=function(b,c){k.accountchooser[O].notEmpty(b,Y);this.method_=k.accountchooser.rpc.ManageRequest.METHOD;this.params_={clientConfig:c};this.id_=b};k.accountchooser.rpc.ManageRequest.inheritsFrom(k.accountchooser.rpc[J]);k.accountchooser.rpc.ManageRequest.METHOD=vc;
k.accountchooser.rpc.QueryRequest=function(b,c,d,e){k.accountchooser[O].notEmpty(b,Y);k.accountchooser[O].notEmpty(c,Fc);this.method_=k.accountchooser.rpc.QueryRequest.METHOD;this.params_={query:c,account:d,clientConfig:e};this.id_=b};k.accountchooser.rpc.QueryRequest.inheritsFrom(k.accountchooser.rpc[J]);k.accountchooser.rpc.QueryRequest.METHOD=Fc;k.accountchooser.rpc.Queries={CDS_DISABLED:"cdsDisabled",CDS_EMPTY:"cdsEmpty",ACCOUNT_EXIST:"accountExist"};
k.accountchooser.rpc.IdpReadyNotification=function(){this.method_=k.accountchooser.rpc.IdpReadyNotification.METHOD};k.accountchooser.rpc.IdpReadyNotification.inheritsFrom(k.accountchooser.rpc.Notification);k.accountchooser.rpc.IdpReadyNotification.METHOD="idpReadyNotification";
k.accountchooser.rpc.IdpAuthRequest=function(b,c){k.accountchooser[O].notEmpty(b,Ub);this.method_=k.accountchooser.rpc.IdpAuthRequest.METHOD;this.params_={account:b,clientConfig:c};this.id_=k.accountchooser.rpc.IdpAuthRequest.DEFAULT_ID+X+b.email};k.accountchooser.rpc.IdpAuthRequest.inheritsFrom(k.accountchooser.rpc[J]);k.accountchooser.rpc.IdpAuthRequest.METHOD="idpAuth";k.accountchooser.rpc.IdpAuthRequest.DEFAULT_ID="idpAuth";
k.accountchooser.rpc.parseRpcObject=function(b){var c=h;if(b){try{var d=n[la](b)}catch(e){return k.accountchooser.util.log(pb),c}if(!d||d.jsonrpc!=Ha)k.accountchooser.util.log(qb);else if(d.method){var f=d.method[V]();f==k.accountchooser.rpc.StoreRequest.METHOD[V]()?d.id&&(d.params&&d.params.account)&&(c=new k.accountchooser.rpc.StoreRequest(d.id,d.params.account,d.params.localAccounts,d.params.clientConfig)):f==k.accountchooser.rpc.SelectRequest.METHOD[V]()?d.id&&(c=new k.accountchooser.rpc.SelectRequest(d.id,
d.params.localAccounts,d.params.clientConfig)):f==k.accountchooser.rpc.UpdateRequest.METHOD[V]()?d.id&&(d.params&&d.params.account)&&(c=new k.accountchooser.rpc.UpdateRequest(d.id,d.params.account,d.params.clientConfig)):f==k.accountchooser.rpc.ManageRequest.METHOD[V]()?d.id&&(c=new k.accountchooser.rpc.ManageRequest(d.id,d.params.clientConfig)):f==k.accountchooser.rpc.IdpReadyNotification.METHOD[V]()&&(c=new k.accountchooser.rpc.IdpReadyNotification)}else typeof d.id===Sc&&0<=d.id[M](k.accountchooser.rpc.IdpAuthRequest.DEFAULT_ID)&&
(c=new k.accountchooser.rpc.Response(d.id,d.result,d.error))}c?k.accountchooser.util.log(Hb+b):k.accountchooser.util.log($a+b);return c};k.accountchooser.rpc.DEFAULT_CDS_DOMAIN="https://www.accountchooser.com";k.accountchooser.rpc.DEFAULT_CDS_IFRAME_PATH="/iframe.html";k.accountchooser.rpc.DEFAULT_CDS_POPUP_PATH="/popup.html";k.accountchooser.rpc.DEFAULT_CDS_REDIRECT_PATH="/redirect.html";k.accountchooser.rpc.DEFAULT_POPUP_WIDTH=520;k.accountchooser.rpc.DEFAULT_POPUP_HEIGHT=550;
k.accountchooser.rpc.EMPTY_RESPONSE_CALLBACK="empty";k.accountchooser.rpc.IDP_TIMEOUT=3E3;k.accountchooser.rpc.RPC_TIMEOUT=3E5;k.accountchooser.rpc.services_={};k.accountchooser.rpc.register=function(b,c){k.accountchooser[O].notEmpty(b,Pc);k.accountchooser[O].notNull(c,fc);k.accountchooser.rpc.services_[b]=c};k.accountchooser.rpc.call=function(b,c,d){k.accountchooser[O].notEmpty(b,Uc);c=c[z]();k.accountchooser.util.log(Fb+c);b[ja](c,d||Ca)};
k.accountchooser.rpc.init_=function(b){k.addEventListener?k.addEventListener(wc,b,i):k[fa]?k[fa](zc,b):k[S][fa]?k[S][fa](zc,b):k.accountchooser.util.log(Db)};k.accountchooser.rpc.SAVED_IN_RPC_PREFIX_="IN_RPC_";k.accountchooser.rpc.SAVED_OUT_RPC_PREFIX_="OUT_RPC_";
k.accountchooser.rpc.readSavedRpcObjects=function(b,c){var d;d=c?k.accountchooser.rpc.SAVED_IN_RPC_PREFIX_:k.accountchooser.rpc.SAVED_OUT_RPC_PREFIX_;d+=b[r](/^https?:\/\//,W);var e=[],f=k[t].getItem(d);if(f){k[t][ia](d);var j=k.JSON[la](f)||[],f=(new Date)[x]();if(j[P]){j=j[j[P]-1];try{var m=n[la](j);m&&m.timestamp&&f-m.timestamp<k.accountchooser.rpc.RPC_TIMEOUT?(e[I](j),c&&k[t].setItem(d,k.JSON[K](e))):k.accountchooser.util.log(ib+j+Rb)}catch(L){k.accountchooser.util.log(jb+j+Rb)}}}return e};
k.accountchooser.rpc.saveRpcObject=function(b,c,d){b=b[r](/^https?:\/\//,W);k[t][ia](k.accountchooser.rpc.SAVED_IN_RPC_PREFIX_+b);k[t][ia](k.accountchooser.rpc.SAVED_OUT_RPC_PREFIX_+b);d=d?k.accountchooser.rpc.SAVED_IN_RPC_PREFIX_:k.accountchooser.rpc.SAVED_OUT_RPC_PREFIX_;d+=b;b=[];c.setTimestamp();b[I](c[z]());c=k.JSON[K](b);k[t].setItem(d,c)};k.accountchooser.rpc.idps={};k.accountchooser.rpc.idpsIndexedByDomain={};k.accountchooser.rpc.emailMapIdp={};
k.accountchooser.rpc.timer_={running:i,id:0,callback:h};k.accountchooser.rpc.clearTimeoutCallback_=function(){if(k.accountchooser.rpc.timer_.running){try{k.clearTimeout(k.accountchooser.rpc.timer_.id)}catch(b){}k.accountchooser.rpc.timer_.running=i;k.accountchooser.rpc.timer_.id=0;k.accountchooser.rpc.timer_.callback=h}};
k.accountchooser.rpc.setTimeoutCallback_=function(b){k.accountchooser[O].notEmptyFunction(b,Zc);k.accountchooser.rpc.clearTimeoutCallback_();k.accountchooser.rpc.timer_.callback=b;k.accountchooser.rpc.timer_.id=k[B](function(){k.accountchooser.rpc.timer_.callback&&k.accountchooser.rpc.timer_.callback[U](k);k.accountchooser.rpc.timer_.running=i;k.accountchooser.rpc.timer_.id=0;k.accountchooser.rpc.timer_.callback=h},k.accountchooser.rpc.IDP_TIMEOUT);k.accountchooser.rpc.timer_.running=g};
k.accountchooser.rpc.initIdpIFrame_=function(b){!b||!k.accountchooser.rpc.idps[b]?k.accountchooser.util.log(Nb+b+za):k.accountchooser.rpc.idps[b].iframeUrl?k.accountchooser.rpc.initIdpIFrameByConfig_(k.accountchooser.rpc.idps[b]):k.accountchooser.util.log(Za+b+Aa)};k.accountchooser.rpc.initIdpIFrameByConfig_=function(b){if(b&&!b.iframe){var c=o(Ka).css(Dc,Tb).css(bd,Ga).css(hc,Ga).css(rc,Da).appendTo(Vb);b.iframe=c;c.attr(Rc,b.iframeUrl)}};
k.accountchooser.rpc.onIdpReady_=function(b){if(!b||!k.accountchooser.rpc.idpsIndexedByDomain[b])k.accountchooser.util.log(Ob+b+za);else{var c=k.accountchooser.rpc.idpsIndexedByDomain[b];if(c.iframe){b=c.iframe[0].contentWindow;if(c[A]&&c[A][P]){for(var d=0;d<c[A][P];d++)k.accountchooser.rpc[U](b,c[A][d]);c.queue=[]}c.idpReady=g}else k.accountchooser.util.log(ob+b+xa)}};
k.accountchooser.rpc.callIdp=function(b,c,d,e){b&&k.accountchooser.rpc.idps[b]&&k.accountchooser.rpc.callIdpByConfig(k.accountchooser.rpc.idps[b],c,d,e)};k.accountchooser.rpc.callIdpByDomain=function(b,c,d,e){b&&k.accountchooser.rpc.idpsIndexedByDomain[b]&&k.accountchooser.rpc.callIdpByConfig(k.accountchooser.rpc.idpsIndexedByDomain[b],c,d,e)};
k.accountchooser.rpc.callIdpByConfig=function(b,c,d,e){k.accountchooser[O].notEmpty(b,nc);k.accountchooser[O].notEmpty(c,Hc);k.accountchooser[O].notEmptyFunction(d,Xb);k.accountchooser[O].notEmptyFunction(e,Yc);k.accountchooser.rpc.setTimeoutCallback_(e);k.accountchooser.rpc.addIdpCallback_(b,c,d);if(b.idpReady)k.accountchooser.rpc[U](b.iframe[0].contentWindow,c);else b[A]||(b.queue=[]),b[A][I](c),b.iframe||k.accountchooser.rpc.initIdpIFrameByConfig_(b)};
k.accountchooser.rpc.callIdpByConfig.callbacks_={};k.accountchooser.rpc.addIdpCallback_=function(b,c,d){k.accountchooser.rpc.callIdpByConfig.callbacks_[b.domain+X+c.id_]={callback:d,idpConfig:b}};k.accountchooser.rpc.getIdpCallback_=function(b,c){var d=b+X+c.id_,e=k.accountchooser.rpc.callIdpByConfig.callbacks_[d];if(e)return delete k.accountchooser.rpc.callIdpByConfig.callbacks_[d],e.callback};
k.accountchooser.rpc.isSupportedIdp=function(b){if(b&&(b=b.providerId||k.accountchooser.util.getEmailDomain(b.email)))if((b=k.accountchooser.rpc.emailMapIdp[b])&&k.accountchooser.rpc.idps[b])return b;return i};k.accountchooser.rpc.EMPTY_SAVED_RPC="EMPTY_SAVED_RPC";k.accountchooser.rpc.INVALID_CLIENT_DOMAIN="INVALID_CLIENT_DOMAIN";k.accountchooser.rpc.popupMode=i;k.accountchooser.rpc.clientWindow=h;
k.accountchooser.rpc.getDomainInHash_=function(){if(k[E].hash){var b=k[E].hash;b&&b[0]==ta&&(b=b.substring(1));return b}};k.accountchooser.rpc.triggerSavedRpcs_=function(){if(!k.accountchooser.rpc.popupMode){var b=k.accountchooser.rpc.readSavedRpcObjects(k.accountchooser.rpc.clientDomain_,g);if(b&&b[P])for(var c=0;c<b[P];c++)k.accountchooser.rpc.process_({data:b[c],origin:k.accountchooser.rpc.clientDomain_},g);else throw k.accountchooser.rpc.EMPTY_SAVED_RPC;}};
k.accountchooser.rpc.sendCdsReadyNotification_=function(){if(k.accountchooser.rpc.popupMode){var b=new k.accountchooser.rpc.CdsReadyNotification;k.accountchooser.rpc.clientWindow[ja](b[z](),Ca)}};
k.accountchooser.rpc.process_=function(b,c){k.accountchooser.util.log(Cb+b[s]+oa+b[p]);var d=b[p][r](/^https?:\/\//,W),e=k.accountchooser.rpc.parseRpcObject(b[s]);if(e)if(e instanceof k.accountchooser.rpc.ManageRequest&&!c)k.accountchooser.util.log(nb+b[s]);else if(e instanceof k.accountchooser.rpc.IdpReadyNotification)k.accountchooser.rpc.onIdpReady_(d);else if(e instanceof k.accountchooser.rpc.Response)k.accountchooser.rpc.clearTimeoutCallback_(),(d=k.accountchooser.rpc.getIdpCallback_(d,e))?d[U](k,
e,b[p],d.context):k.accountchooser.util.log(Wa+b[s]);else if(e instanceof k.accountchooser.rpc[J]){if(k.accountchooser.rpc.checkCallbackDomain_(e,d))if(d=k.accountchooser.rpc.services_.serviceLoader){if(e instanceof k.accountchooser.rpc[J]&&!c){var f=new k.accountchooser.rpc.RequestAckNotification(e.id_);k.parent[ja](f[z](),b[p])}d(e,b[p])}else k.accountchooser.util.log(ub+e.method_+wa)}else k.accountchooser.util.log(Mb+b[s]);else k.accountchooser.util.log(Ta+b[s])};
k.accountchooser.rpc.checkCallbackDomain_=function(b,c){var d=b.params_.clientConfig.clientCallbackUrl&&k.accountchooser.util.getDomainFromUrl(b.params_.clientConfig.clientCallbackUrl);return d&&d!==c?(k.accountchooser.util.log(kb+b.params_.clientConfig.clientCallbackUrl+pa+c+qa),i):(d=b.params_.clientConfig.positiveCallbackUrl&&k.accountchooser.util.getDomainFromUrl(b.params_.clientConfig.positiveCallbackUrl))&&d!==c?(k.accountchooser.util.log(mb+b.params_.clientConfig.positiveCallbackUrl+pa+c+qa),
i):(d=b.params_.clientConfig.negativeCallbackUrl&&k.accountchooser.util.getDomainFromUrl(b.params_.clientConfig.negativeCallbackUrl))&&d!==c?(k.accountchooser.util.log(lb+b.params_.clientConfig.negativeCallbackUrl+pa+c+qa),i):g};
k.accountchooser.rpc.initIdp_=function(b,c){var d=[];if(b)for(var e in b){k.accountchooser[O].notEmpty(b[e].iframeUrl,oc);var f=b[e].iframeUrl,j=k.accountchooser.util.getDomainFromUrl(f);k.accountchooser[O].notEmpty(j,cc);f={id:e,domain:j,iframe:h,iframeUrl:f,queue:[],idpReady:i};k.accountchooser.rpc.idps[e]=f;k.accountchooser.rpc.idpsIndexedByDomain[j]=f;b[e].preload&&d[I](e)}if(c)for(var m in c)(e=c[m])?k.accountchooser.rpc.idps[e]?k.accountchooser.rpc.emailMapIdp[m]=e:k.accountchooser.util.log(rb+
m+ra):k.accountchooser.util.log(sb+m+sa);return d};
k.accountchooser.rpc.initCds=function(b){var c;if(b){if(b.rpcs)for(var d in b.rpcs)k.accountchooser.rpc.register(d,b.rpcs[d]);c=k.accountchooser.rpc.initIdp_(b.idps,b.emailMapIdp)}if(b&&b.popupMode)k.accountchooser.rpc.popupMode=g,k.accountchooser.rpc.clientWindow=k.opener;else{k.accountchooser.rpc.popupMode=i;d=k.accountchooser.rpc.getDomainInHash_();if(!d)throw k.accountchooser.util.log(Ya),k.accountchooser.rpc.INVALID_CLIENT_DOMAIN;k.accountchooser.rpc.clientDomain_=d}k.accountchooser.rpc.init_(k.accountchooser.rpc.process_);
k.accountchooser.rpc.popupMode&&k.accountchooser.rpc.sendCdsReadyNotification_();if(c&&c[P])for(d=0;d<c[P];d++)k.accountchooser.rpc.initIdpIFrame_(c[d]);b&&!b.popupMode&&k.accountchooser.rpc.triggerSavedRpcs_()};
k.accountchooser.rpc.callClient=function(b){k.accountchooser[O].notEmpty(b,Jc);k.accountchooser.util.log(Fb+b[z]());k.accountchooser.rpc.popupMode?k.accountchooser.rpc.clientWindow[ja](b[z](),Ca):k.accountchooser.rpc.clientDomain_?k.accountchooser.rpc.saveRpcObject(k.accountchooser.rpc.clientDomain_,b,i):k.accountchooser.util.log(Ra)};k.accountchooser.UiLoader=function(){};Z=k.accountchooser.UiLoader[R];Z.findServiceByLanguage_=function(b,c,d){return!b?h:d&&b[d]&&b[d][c]?b[d][c]:b[c]};
Z.findService_=function(b,c,d,e){var f=h;c&&(b=b.method_,d&&c.mobile&&(f=this.findServiceByLanguage_(c.mobile,b,e)),f||(f=this.findServiceByLanguage_(c.web,b,e)));return f};Z.loadServiceFromWeb=function(){throw Lb;};Z.isServiceLoaded=function(){throw Lb;};Z.setServiceLoaded=function(){throw Lb;};
Z.loadService=function(b,c,d){var e=k.accountchooser.util.isMobileAgent(aa.userAgent),f=b&&b.params_&&b.params_.clientConfig&&b.params_.clientConfig[Q],b=this.findService_(b,c,e,f);k.accountchooser[O].notEmpty(b,Nc);k.accountchooser[O].notEmpty(b[ka],Oc);var j=o[ea]({},b,{mobile:!!e,language:f});if(this.isServiceLoaded(j))e=k.accountchooser.util.getNamespacedObjectByString(j[ka]),k.accountchooser[O].notEmpty(e,j[ka]),d(e);else{var m=this;this.loadServiceFromWeb(j,function(){m.setServiceLoaded(j);
var b=k.accountchooser.util.getNamespacedObjectByString(j[ka]);k.accountchooser[O].notEmpty(b,j[ka]);d(b)})}};k.accountchooser.UrlUiLoader=function(){this.loadedUrls_=[]};k.accountchooser.UrlUiLoader.inheritsFrom(k.accountchooser.UiLoader);k.accountchooser.UrlUiLoader[R].getFileUrl=function(){throw Lb;};
k.accountchooser.UrlUiLoader[R].loadServiceFromWeb=function(b,c){var d=l.getElementsByTagName(gc)[0]||l[y],e=l[v](Lc);e.src=this.getFileUrl(b);var f=i;ba(e,da(e,function(){if(!f&&(!this[N]||this[N]===tc||this[N]===Zb))f=g,ba(e,da(e,h)),c()}));d.insertBefore(e,d.firstChild)};k.accountchooser.UrlUiLoader[R].isServiceLoaded=function(b){b=this.getFileUrl(b);return-1<o[D](b,this.loadedUrls_)};
k.accountchooser.UrlUiLoader[R].setServiceLoaded=function(b){b=this.getFileUrl(b);0>o[D](b,this.loadedUrls_)&&this.loadedUrls_[I](b)};k.accountchooser.UrlTemplateUiLoader=function(b,c){this.loadedUrls_=[];this.urlTemplate_=b;this.defaultLanguage_=k.accountchooser.util.findLanguageCode(c)||dc};k.accountchooser.UrlTemplateUiLoader.inheritsFrom(k.accountchooser.UrlUiLoader);
k.accountchooser.UrlTemplateUiLoader[R].getFileUrl=function(b){var c=b[Q]||k.navigator[Q],c=k.accountchooser.util.findLanguageCode(c)||this.defaultLanguage_;return this.urlTemplate_[r](/\{baseFilename\}/,b.baseFilename)[r](/\{language\}/,c)};k.accountchooser.AjaxUiLoader=function(){this.loadedPackages_=[]};k.accountchooser.AjaxUiLoader.inheritsFrom(k.accountchooser.UiLoader);k.accountchooser.AjaxUiLoader[R].stringify=function(b){return b.module+X+b.version+X+b.packageName+X+b[Q]};
k.accountchooser.AjaxUiLoader[R].loadServiceFromWeb=function(b,c){google.load(b.module,b.version,{packages:[b.packageName],language:b[Q]||k.navigator[Q],callback:c})};k.accountchooser.AjaxUiLoader[R].isServiceLoaded=function(b){b=this[K](b);return-1<o[D](b,this.loadedPackages_)};k.accountchooser.AjaxUiLoader[R].setServiceLoaded=function(b){b=this[K](b);0>o[D](b,this.loadedPackages_)&&this.loadedPackages_[I](b)};
var ed=o,hd={options:{popupMode:i,manageMode:i,Uiloader:new k.accountchooser.UrlTemplateUiLoader("javascript/{baseFilename}__{language}.js","javascript/{baseFilename}__en.js"),idps:{},emailMapIdp:{},uiHandler:h,enableCajole:i},loadService_:function(b,c){var d=this;this[F].Uiloader.loadService(b,this[F].services,function(e){d.executeService_(e,b,c)})},executeService_:function(b,c,d){b=new b;b.setContainer(this.element);b.setCdsConfig(this.cdsConfig);b.executeRequest[U](b,c);this.showCustomizedUI_(c,
d)},showCustomizedUI_:function(b,c){if(this.cdsConfig.uiHandler){var d={};b&&(b.params_&&b.params_.clientConfig&&b.params_.clientConfig.ui&&this.cdsConfig.uiHandler)&&(d=b.params_.clientConfig.ui,d.language=b.params_.clientConfig[Q],!this.cdsConfig.enableCajole&&(d.main&&Wb==d.main.method)&&(d.main.method=Kc));d.language=d[Q]||dc;d.domain=c[r](/^https?:\/\//,W);this.cdsConfig.uiHandler(d)}},_create:function(){ed(this.element).empty();this.cdsConfig={popupMode:this[F].popupMode,idps:this[F].idps,emailMapIdp:this[F].emailMapIdp,
uiHandler:this[F].uiHandler,enableCajole:!!this[F].enableCajole};this.cdsConfig.rpcs={serviceLoader:ed.proxy(this.loadService_,this)};try{k.accountchooser.rpc.initCds(this.cdsConfig)}catch(b){!this[F].manageMode&&(b==k.accountchooser.rpc.EMPTY_SAVED_RPC||b==k.accountchooser.rpc.INVALID_CLIENT_DOMAIN)&&this.redirectEmptyRequest()}this[F].manageMode&&this.showManagePage()},redirectEmptyRequest:function(){var b=k.accountchooser.rpc.getDomainInHash_();k[E].href=b&&k.accountchooser.util.isValidUrlDomain(b)?
lc+b:k[E].protocol+Fa+k[E].host},showManagePage:function(){var b={language:k.accountchooser.util.parseUrlParams(k[E].href).lang,clientCallbackUrl:k[E].href},b={data:(new k.accountchooser.rpc.ManageRequest(vc,b))[z](),origin:k[E].host};k.accountchooser.rpc.process_(b,g)},destroy:function(){ed(this.element).empty();ed.Widget[R].destroy[U](this)}};ed.widget("ui.cds",hd);})()
